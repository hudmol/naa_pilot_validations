
# naa_pilot_validations

An ArchivesSpace plugin developed for the National Archives of Australia pilot
project that demonstrates some data validations.

## Installation

To install the `naa_pilot_validations` plugin follow this procedure:

  1. Download the latest version of the `naa_pilot_validations` plugin into your
     `archivesspace/plugins/` directory
  2. Add `naa_pilot_validations` to `AppConfig[:plugins]` in `config.rb`
  3. Restart ArchivesSpace


## Configuration

There is no configuration required.


## Validations

This plugin implements the following validation rules:

  * __Unique Digital Object instances__
  
    This rule ensures that an Archival Object can only link to a particular
    Digital Object once via its Instances.


## Implementation Notes

JSNOModel level validations are conventionally defined in a file called:
```
  common/validations.rb
```

This file is then required by the `backend` and `frontend` in their
initialisation files:
```
  backend/plugin_init.rb
  frontend/plugin_init.rb
```

Note that ArchivesSpace's standard set of validations is similarly defined in:
```
  archivesspace/common/validations.rb
```

The translations for validation error messages are declared in `locale` files.
This plugin currently only provides English translations, at:
```
  frontend/locales/en.yml
```

The key for a validation error is the error message that is generated by the
backend, with spaces replaced by underscores and all letters downcased. So, for
example, the unique Digital Object error message from the backend looks like
this:
```
  {
    "error":
    {
      "instances":
      [
        "Cannot have multiple instances of the same digital object"
      ]
    },
    "warning: NULL,
    "invalid_object": "#<JSONModel(:archival_object) {\"publish\"=>false, ...}"
  }
```

And the corresponding translation entry in `frontend/locales/en.yml` looks like
this:
```
  en:
    validation_errors:
      cannot_have_multiple_instances_of_the_same_digital_object: Cannot have more than one instance of the same Digital Object
```
